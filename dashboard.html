<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Dashboard Admin - Blackjack Torneo</title>
<style>
body {
    margin:0;
    font-family: Arial, sans-serif;
    background: #0b3d1e; /* verde felt */
    color: #fff;
}
h1 {
    text-align:center;
    margin: 20px 0;
    font-size: 28px;
    color: #ffd700;
}
#lastUpdate {
    text-align:center;
    margin-bottom: 20px;
    color: #ffd700;
}
table {
    width: 95%;
    margin: 0 auto 40px;
    border-collapse: collapse;
    background: #07331e;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
    border-radius: 8px;
    overflow: hidden;
}
th, td {
    padding: 12px 8px;
    text-align: center;
    border-bottom: 1px solid #555;
}
th {
    background: #2c7a3e;
    font-size: 16px;
}
tr:nth-child(even){ background: rgba(255,255,255,0.05); }
tr:hover { background: rgba(255,215,0,0.2); }
</style>
</head>
<body>

<h1>Blackjack Torneo - Classifica</h1>
<div id="lastUpdate">Aggiornamento: --</div>

<table>
    <thead>
        <tr>
            <th>Posizione</th>
            <th>Username / ID</th>
            <th>Balance (â‚¬)</th>
            <th>Mani rimaste</th>
            <th>Ultima partita</th>
        </tr>
    </thead>
    <tbody id="leaderboard">
        <!-- Dati giocatori -->
    </tbody>
</table>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="firebase.js"></script> <!-- il tuo file config -->

<script>
const playersRef = firebase.database().ref("blackjack/players");

// Aggiornamento live della classifica
playersRef.on('value', snapshot=>{
    const data = snapshot.val();
    if(!data) return;

    // Ordina per balance decrescente
    const sorted = Object.entries(data).sort((a,b)=>b[1].balance - a[1].balance);

    const tbody = document.getElementById("leaderboard");
    tbody.innerHTML = "";

    sorted.forEach(([id, player], index)=>{
        const tr = document.createElement("tr");
        const date = new Date(player.timestamp).toLocaleString();
        tr.innerHTML = `
            <td>${index+1}</td>
            <td>${player.username || id}</td>
            <td>${player.balance}</td>
            <td>${player.handsLeft}</td>
            <td>${date}</td>
        `;
        tbody.appendChild(tr);
    });

    document.getElementById("lastUpdate").innerText = "Aggiornamento: " + new Date().toLocaleTimeString();
});
</script>

</body>
</html>
